## ライブラリ

google-adk：1.19.0


## 手順

education_agent配下で以下のように仮想環境を作成する(別のやり方でも良い)

python -m venv 仮想環境名

Windowsならば

.\仮想環境名\Scripts\activate

で仮想環境に入れる

仮想環境に入ったあと

pip install google-adk==1.19.0

でパッケージをインストールし、

adk web --no-reload

でAIエージェントが起動するため、ターミナルに表示されたリンクをクリックし入室

.envファイルにてyour_api_key,your_project_id(3箇所),your_location,your_datastore_id(2箇所)を入力する必要あり。

VerexAIを叩き、geminiとRAGを使用、結構なお金がかかるので実行時は注意


## 出力の例

#### ユーザー
統計学の問題を作成してください。初級・中級・上級で作ってもらえると幸いです。
#### AIエージェント

### **【初級】カイ二乗適合度検定** 
#### **問題** 
あるお菓子工場では、5種類の色（赤、青、緑、黄、紫）のキャンディーが、均等な割合（各20%）で生産されるように設定されています。品質管理のためにランダムに100個を抽出したところ、以下の結果となりました。 

| 色 | 観測度数（個） | 

| :--- | :---: | 

| 赤 | 25 | 

| 青 | 18 | 

| 緑 | 19 | 

| 黄 | 22 | 

| 紫 | 16 | 

| **合計** | **100** | 

このキャンディーの色の割合は、工場が設定した「均等な割合」から有意に異なっていると言えるでしょうか。カイ二乗適合度検定を用いて、有意水準5%（α=0.05）で検定してください。ただし、自由度4におけるカイ二乗分布の上側5%点は9.488です。 
<details><summary><strong>解答</strong></summary> 

* **カイ二乗値 (χ²):** 2.5 
* **結論:** カイ二乗値 (2.5) < 棄却点の値 (9.488) であるため、帰無仮説は棄却されません。したがって、このキャンディーの色の割合が工場が設定した均等な割合と異なるとは言えません。 
</details> <details><summary><strong>解説</strong></summary> 

1. **仮説の設定** 
* 帰無仮説 (H₀): 観測された色の割合は、期待される割合（各20%）と差がない。 
* 対立仮説 (H₁): 観測された色の割合は、期待される割合と差がある。 

2. **期待度数の計算** 
期待度数は、「もし帰無仮説が正しければ（＝各色が均等に20%ずつなら）、100個中の各色の個数はいくつか」という理論値です。 期待度数 = 全体の合計 × 期待される割合 = 100 × 0.20 = **20個** (すべての色で共通) 
3. **カイ二乗値 (χ²) の計算** カイ二乗値は、観測度数と期待度数のズレの大きさを測る指標です。 `χ² = Σ [ (観測度数 - 期待度数)² / 期待度数 ]` χ² = (25 - 20)²/20 + (18 - 20)²/20 + (19 - 20)²/20 + (22 - 20)²/20 + (16 - 20)²/20 = (5)²/20 + (-2)²/20 + (-1)²/20 + (2)²/20 + (-4)²/20 = 25/20 + 4/20 + 1/20 + 4/20 + 16/20 = (25 + 4 + 1 + 4 + 16) / 20 = 50 / 20 = **2.5** 
4. **判定** 
* 自由度 (df) = (カテゴリの数 - 1) = 5 - 1 = 4 
* 有意水準5%、自由度4のカイ二乗分布における棄却点の値は、問題文より **9.488** です。 
* 算出したカイ二乗値 (χ² = 2.5) は、この棄却点の値 (9.488) よりも小さいです。 
5. **結論** カイ二乗値が棄却域に入らないため、帰無仮説は棄却されません。したがって、有意水準5%において、今回のサンプルから得られた色のばらつきは偶然の範囲内と判断され、**「生産されるキャンディーの色の割合が均等でない」とまでは主張できない**、という結論になります。 </details> 
--- 
### **【中級】分散分析（ANOVA）表の穴埋め** 
#### **問題** 
ある教育機関が、3つの異なる学習方法（A: 講義、B: グループワーク、C: オンライン教材）がテストの点数に与える影響を調べるため、各方法を5人の生徒に割り当てて実験を行いました。得られたデータから分散分析表を作成したところ、一部が空欄になりました。

 | 要因 | 平方和 (SS) | 自由度 (df) | 平均平方 (MS) | F値 | 

 | :--- | :---: | :---: | :---: | :---: | 

 | 水準間（学習方法） | 36.0 | **（A）** | **（C）** | **（E）** | 

 | 残差（誤差） | **（B）** | 12 | **（D）** | | 

 | 合計 | 60.0 | 14 | | | 
 
 この分散分析表の空欄（A）〜（E）を埋め、F値を求めてください。そして、有意水準5%（α=0.05）で「学習方法によってテストの点数に有意な差はあるか」について結論を述べてください。ただし、自由度(2, 12)におけるF分布の上側5%点は3.89です。 
 <details><summary><strong>解答</strong></summary> 
  
 * **(A):** 2, **(B):** 24.0, **(C):** 18.0, **(D):** 2.0, **(E):** 9.0
 * * **結論:** F値 (9.0) > 棄却点の値 (3.89) であるため、帰無仮説は棄却されます。したがって、有意水準5%で、学習方法によってテストの点数に有意な差があると言えます。 </details> 
 <details><summary><strong>解説</strong></summary> 
 分散分析表は、各要素が互いに関連しあっています。以下の手順で空欄を埋めていきます。 

 1. **自由度 (df) の計算** 自由度は足し算・引き算で求められます。（合計 = 水準間 + 残差） 
 * **(A) 水準間の自由度:** df_A = 合計の自由度 - 残差の自由度 = 14 - 12 = **2** (別解: 水準の数 - 1 = 3 - 1 = 2) 
 2. **平方和 (SS) の計算** 平方和も同様に足し算・引き算で求められます。（合計 = 水準間 + 残差） 
 * **(B) 残差の平方和:** SSE = 合計の平方和 - 水準間の平方和 = 60.0 - 36.0 = **24.0** 
 3. **平均平方 (MS) の計算** 平均平方は「平方和 ÷ 自由度」で求められます。 
 * **(C) 水準間の平均平方:** MSA = 水準間の平方和 / 水準間の自由度 = 36.0 / (A) = 36.0 / 2 = **18.0** 
 * **(D) 残差の平均平方:** MSE = 残差の平方和 / 残差の自由度 = (B) / 12 = 24.0 / 12 = **2.0** 
 4. **F値の計算** F値は「水準間の平均平方 ÷ 残差の平均平方」で求められます。 
 * **(E) F値:** F = MSA / MSE = (C) / (D) = 18.0 / 2.0 = **9.0** 
 5. **結論** 
 * 帰無仮説: 3つの学習方法によるテストの点数の母平均に差はない。 
 * 対立仮説: 少なくとも1つの学習方法は、他の方法と母平均が異なる。 
 * 算出したF値 (9.0) は、問題で与えられた棄却点の値 (F(2, 12, 0.05) = 3.89) よりも大きいです。 
 * F値が棄却域に入るため、帰無仮説は棄却されます。したがって、**学習方法によってテストの点数には統計的に有意な差がある**と結論付けられます。 </details> 
 --- 
 ### **【上級】重回帰分析のモデル解釈** 
 #### **問題** 
 あるECサイトの月間売上（万円）を予測するために、複数の説明変数を用いて重回帰分析を行ったところ、以下の結果が得られました。 
 * **目的変数 (y):** 月間売上（万円） 
 * **説明変数:** 
 * x₁: 広告費（万円） 
 * x₂: サイト訪問者数（1000人単位） 
 * x₃: 平均レビュー評価（5点満点） 
 * **分析結果の概要:** 
 * **決定係数 (R²):** 0.78 
 * **各係数の推定値とp値:** 

 | 変数 | 係数 | p値 | 

 | :--- | :---: | :---: | 

 | 切片 | 30.5 | 0.03 | 

 | 広告費 (x₁) | 5.2 | 0.002 | 

 | 訪問者数 (x₂) | 15.8 | 0.28 | 

 | レビュー評価 (x₃) | 25.4 | 0.04 | 
 * **標準化偏回帰係数:** 
 
 | 変数 | 標準化係数 | 

 | :--- | :---: | 

 | 広告費 (x₁) | 0.71 | 

 | 訪問者数 (x₂) | 0.12 | 

 | レビュー評価 (x₃) | 0.25 | 
 
 この分析結果について、以下の問いに答えてください。 
 1. 決定係数 R² = 0.78 は、このモデルについて何を意味していますか。 
 2. 「レビュー評価 (x₃)」の係数 "25.4" は、どのように解釈できますか。 
 3. 有意水準5%（α=0.05）で判断した場合、月間売上に統計的に有意な影響を与えていると言える変数はどれですか。すべて挙げてください。 
 4. 3つの説明変数のうち、月間売上に対して最も影響力が強いと考えられる変数はどれですか。その理由も簡潔に述べてください。

 <details><summary><strong>解答</strong></summary> 

 1. 月間売上の変動の78%が、「広告費」「サイト訪問者数」「平均レビュー評価」の3つの変数によって説明できることを意味します。 
 2. 広告費とサイト訪問者数が一定の場合、平均レビュー評価が1点上がると、月間売上が25.4万円増加すると予測される、と解釈できます。 
 3. 広告費 (x₁) と レビュー評価 (x₃) 
 4. 最も影響力が強い変数は「広告費 (x₁)」。理由は、標準化偏回帰係数の絶対値 (0.71) が3つの変数の中で最も大きいためです。</details> 

 <details><summary><strong>解説</strong></summary> 

 1. **決定係数 (R²) の解釈** 決定係数は、モデルが目的変数の変動をどれだけうまく説明できているかを示す指標です。R²=0.78は、この回帰モデルの当てはまりが良好であることを示唆しており、月間売上のばらつきの78%が、モデルに投入された3つの説明変数によって捉えられていることを意味します。 
 2. **偏回帰係数の解釈** 重回帰分析における各変数の係数（偏回帰係数）は、「他のすべての説明変数の値が一定である」という条件下での影響度を表します。「レビュー評価 (x₃)」の係数が25.4であることから、広告費と訪問者数の影響を除いた上で、レビュー評価が1点上昇するごとに月間売上が25.4万円増加する関係があることが分かります。 
 3. **p値による有意性の判断** p値は「もしその係数の本当の値が0であった場合に、観測されたような値が得られる確率」を示します。慣例的に、このp値が有意水準（ここでは0.05）より小さい場合に、「その係数は統計的に有意に0とは異なる」と判断します。 
 * 広告費 (x₁): p = 0.002 < 0.05 (有意) 
 * 訪問者数 (x₂): p = 0.28 > 0.05 (有意ではない) 
 * レビュー評価 (x₃): p = 0.04 < 0.05 (有意) よって、月間売上に有意な影響を与えている変数は**広告費**と**レビュー評価**です。サイト訪問者数の影響は、このモデルでは統計的に意味のあるものとは言えません。 
 4. **影響力の比較** 単位が異なる説明変数同士の影響力を直接比較するには、係数の大きさではなく「標準化偏回帰係数」の絶対値を用います。これは、各変数を標準化（平均0, 標準偏差1に変換）した上で回帰分析を行った際の係数であり、単位の影響を受けません。 
 * 広告費: |0.71| = 0.71 
 * 訪問者数: |0.12| = 0.12 
 * レビュー評価: |0.25| = 0.25 この中で絶対値が最も大きいのは**広告費 (0.71)**であるため、この3つの変数の中では広告費が月間売上に対して最も強い影響力を持つ変数であると判断できます。 </details>

#### ユーザー
すごい！ちなみにPDFの中にこれらの問題を解くことに使えそうなものってあったりするかな？
#### AIエージェント
どのような問題について知りたいでしょうか？

お手数ですが、具体的な問題の内容を教えていただけますでしょうか。そうすれば、PDFの中に解決に役立つ情報があるか確認できます。

#### ユーザー
先程作ってくださった問題です。
### AIエージェント
ご指定の統計手法について、PDF内に以下の関連情報があるか確認しました。 
### 確認結果 
* **カイ二乗検定:** **関連情報が見つかりました。** 
* PDF内では、カイ二乗分布に基づく検定を総称してカイ二乗検定と呼ぶと説明されています。 帰無仮説のもとで期待される度数と、実際の観測度数との乖離を表すカイ二乗統計量に基づき検定を行う手法です。 具体的には、独立性の検定手続きについての記述が確認できました。 また、正規分布の分散の推定量が、適切なスケーリングの下でカイ二乗分布に従うという性質についても触れられています。 
* **重回帰分析:** **関連情報が見つかりました。** 
* 目的変数の分布が正規分布に従うと仮定できるときに用いられる、最も一般的な回帰の手法として紹介されています。 重回帰分析は、連続値の予測（例: 需要量や年収の予測）に用いられる手法の一つです。 具体例として、州ごとの貧困率や片親の割合から犯罪発生件数を予測する重回帰モデルが示されています。 
* **分散分析:** **関連情報は見つかりませんでした。** 
* PDF内を検索しましたが、「分散分析（ANOVA）」について直接解説している箇所は見つかりませんでした。「分散」という用語自体は、ウォード法によるクラスタリングやポアソン分布の説明で言及されていますが、これは分散分析の手法を説明するものではありません。
